<?php

namespace App\Http\Controllers\Crm;

use App\Models\Crm\ProjectLogModel;
use App\Models\Crm\UserModel;
use App\Models\Crm\LedgerModel;
use Illuminate\Http\Request;
use App\Http\Controllers\Controller;

class ProjectLogController extends Controller
{
    public $projectLogModel;
    public $userModel;
    public $ledgerModel;
    public $request;
    public $email_city = [
        ['liqing@doumi.com','武汉'],
        ['gengchang@doumi.com','西安'],
        ['cuican@doumi.com','郑州'],
        ['wuxiaodie@doumi.com','杭州'],
        ['pengyi@doumi.com','成都'],
        ['ouyanghui@doumi.com','深圳'],
        ['fangchunxue@doumi.com','济南'],
        ['shiduxin@doumi.com','上海'],
        ['lihuiling@doumi.com','广州'],
        ['linhaisong@doumi.com','青岛'],
        ['liuzhu1@doumi.com','重庆'],
        ['lixiaotong@doumi.com','沈阳'],
        ['liangqin@doumi.com','长沙'],
        ['zhangxin2@doumi.com','南京'],
        ['wangjiajia@doumi.com','石家庄'],
        ['gaokeli@doumi.com','合肥'],
        ['lishuyan1@doumi.com','天津'],
        ['yangying@doumi.com','贵阳'],
        ['zhangmeng5@doumi.com','太原'],
        ['tianyangyang@doumi.com','大连'],
        ['xuli4@doumi.com','昆明'],
        ['xusiming@doumi.com','厦门'],
        ['xiongyu@doumi.com','南昌'],
        ['yuyan1@doumi.com','苏州'],
        ['qiudanyi@doumi.com','福州'],
        ['fanjinfeng@doumi.com','长春'],
        ['mengtiantian1@doumi.com','北京'],
        ['juxiaotong@doumi.com','电销']
    ];
    public $email = [
        'liqing@doumi.com',
        'gengchang@doumi.com',
        'cuican@doumi.com',
        'wuxiaodie@doumi.com',
        'pengyi@doumi.com',
        'ouyanghui@doumi.com',
        'fangchunxue@doumi.com',
        'shiduxin@doumi.com',
        'lihuiling@doumi.com',
        'linhaisong@doumi.com',
        'liuzhu1@doumi.com',
        'lixiaotong@doumi.com',
        'liangqin@doumi.com',
        'zhangxin2@doumi.com',
        'wangjiajia@doumi.com',
        'gaokeli@doumi.com',
        'lishuyan1@doumi.com',
        'yangying@doumi.com',
        'zhangmeng5@doumi.com',
        'tianyangyang@doumi.com',
        'xuli4@doumi.com',
        'xusiming@doumi.com',
        'xiongyu@doumi.com',
        'yuyan1@doumi.com',
        'qiudanyi@doumi.com',
        'fanjinfeng@doumi.com',
        'mengtiantian1@doumi.com',
        'juxiaotong@doumi.com',
    ];
    public $ledger_no = [
        'SCSY1803140001CD',
        'SCSY1803140002CD',
        'SCSY1803140003CD',
        'SCSY1803140004CD',
        'SCSY1803140005CD',
        'SCSY1803140006CD',
        'SCSY1803140007CD',
        'SCSY1803140008CD',
        'SCSY1803140009CD',
        'SCSY1803140010CD',
        'SCSY1803140011CD',
        'SCSY1803140012CD',
        'SCSY1803140013CD',
        'SCSY1803140014CD',
        'SCSY1803140015CD',
        'SCSY1803140016CD',
        'SCSY1803140017CD',
        'SCSY1803140018CD',
        'SCSY1803140019CD',
        'SCSY1803140020CD',
        'SCSY1803140021HF',
        'SCSY1803140022HF',
        'SCSY1803140023HF',
        'SCSY1803140024HF',
        'SCSY1803140025HF',
        'SCSY1803140026HF',
        'SCSY1803140027HF',
        'SCSY1803140028HF',
        'SCSY1803140029HF',
        'SCSY1803140030HF',
        'SCSY1803140031HF',
        'SCSY1803140032HF',
        'SCSY1803140033HF',
        'SCSY1803140034HF',
        'SCSY1803140035HF',
        'SCSY1803140036HF',
        'SCSY1803140037HF',
        'SCSY1803140038HF',
        'SCSY1803140039HF',
        'SCSY1803140040HF',
        'SCSY1803140041NJ',
        'SCSY1803140042NJ',
        'SCSY1803140043NJ',
        'SCSY1803140044NJ',
        'SCSY1803140045NJ',
        'SCSY1803140046NJ',
        'SCSY1803140047NJ',
        'SCSY1803140048NJ',
        'SCSY1803140049NJ',
        'SCSY1803140050NJ',
        'SCSY1803140051NJ',
        'SCSY1803140052NJ',
        'SCSY1803140053NJ',
        'SCSY1803140054NJ',
        'SCSY1803140055NJ',
        'SCSY1803140056NJ',
        'SCSY1803140057NJ',
        'SCSY1803140058NJ',
        'SCSY1803140059NJ',
        'SCSY1803140060NJ',
        'SCSY1803140061SJZ',
        'SCSY1803140062SJZ',
        'SCSY1803140063SJZ',
        'SCSY1803140064SJZ',
        'SCSY1803140065SJZ',
        'SCSY1803140066SJZ',
        'SCSY1803140067SJZ',
        'SCSY1803140068SJZ',
        'SCSY1803140069SJZ',
        'SCSY1803140070SJZ',
        'SCSY1803140071SJZ',
        'SCSY1803140072SJZ',
        'SCSY1803140073SJZ',
        'SCSY1803140074SJZ',
        'SCSY1803140075SJZ',
        'SCSY1803140076SJZ',
        'SCSY1803140077SJZ',
        'SCSY1803140078SJZ',
        'SCSY1803140079SJZ',
        'SCSY1803140080SJZ',
        'SCSY1803140081SUZ',
        'SCSY1803140082SUZ',
        'SCSY1803140083SUZ',
        'SCSY1803140084SUZ',
        'SCSY1803140085SUZ',
        'SCSY1803140086SUZ',
        'SCSY1803140087SUZ',
        'SCSY1803140088SUZ',
        'SCSY1803140089SUZ',
        'SCSY1803140090SUZ',
        'SCSY1803140091SUZ',
        'SCSY1803140092SUZ',
        'SCSY1803140093SUZ',
        'SCSY1803140094SUZ',
        'SCSY1803140095SUZ',
        'SCSY1803140096SUZ',
        'SCSY1803140097SUZ',
        'SCSY1803140098SUZ',
        'SCSY1803140099SUZ',
        'SCSY1803140100SUZ',
        'SCSY1803140101CS',
        'SCSY1803140102CS',
        'SCSY1803140103CS',
        'SCSY1803140104CS',
        'SCSY1803140105CS',
        'SCSY1803140106CS',
        'SCSY1803140107CS',
        'SCSY1803140108CS',
        'SCSY1803140109CS',
        'SCSY1803140110CS',
        'SCSY1803140111CS',
        'SCSY1803140112CS',
        'SCSY1803140113CS',
        'SCSY1803140114CS',
        'SCSY1803140115CS',
        'SCSY1803140116CS',
        'SCSY1803140117CS',
        'SCSY1803140118CS',
        'SCSY1803140119CS',
        'SCSY1803140120CS',
        'SCSY1803140121FZ',
        'SCSY1803140122FZ',
        'SCSY1803140123FZ',
        'SCSY1803140124FZ',
        'SCSY1803140125FZ',
        'SCSY1803140126FZ',
        'SCSY1803140127FZ',
        'SCSY1803140128FZ',
        'SCSY1803140129FZ',
        'SCSY1803140130FZ',
        'SCSY1803140131NC',
        'SCSY1803140132NC',
        'SCSY1803140133NC',
        'SCSY1803140134NC',
        'SCSY1803140135NC',
        'SCSY1803140136NC',
        'SCSY1803140137NC',
        'SCSY1803140138NC',
        'SCSY1803140139NC',
        'SCSY1803140140NC',
        'SCSY1803140141QD',
        'SCSY1803140142QD',
        'SCSY1803140143QD',
        'SCSY1803140144QD',
        'SCSY1803140145QD',
        'SCSY1803140146QD',
        'SCSY1803140147QD',
        'SCSY1803140148QD',
        'SCSY1803140149QD',
        'SCSY1803140150QD',
        'SCSY1803140151XM',
        'SCSY1803140152XM',
        'SCSY1803140153XM',
        'SCSY1803140154XM',
        'SCSY1803140155XM',
        'SCSY1803140156XM',
        'SCSY1803140157XM',
        'SCSY1803140158XM',
        'SCSY1803140159XM',
        'SCSY1803140160XM',
        'SCSY1803140161TY',
        'SCSY1803140162TY',
        'SCSY1803140163TY',
        'SCSY1803140164TY',
        'SCSY1803140165TY',
        'SCSY1803140166TY',
        'SCSY1803140167TY',
        'SCSY1803140168TY',
        'SCSY1803140169TY',
        'SCSY1803140170TY',
        'SCSY1803140171TJ',
        'SCSY1803140172TJ',
        'SCSY1803140173TJ',
        'SCSY1803140174TJ',
        'SCSY1803140175TJ',
        'SCSY1803140176TJ',
        'SCSY1803140177TJ',
        'SCSY1803140178TJ',
        'SCSY1803140179TJ',
        'SCSY1803140180TJ',
        'SCSY1803140181XA',
        'SCSY1803140182XA',
        'SCSY1803140183XA',
        'SCSY1803140184XA',
        'SCSY1803140185XA',
        'SCSY1803140186XA',
        'SCSY1803140187XA',
        'SCSY1803140188XA',
        'SCSY1803140189XA',
        'SCSY1803140190XA',
        'SCSY1803140191CQ',
        'SCSY1803140192CQ',
        'SCSY1803140193CQ',
        'SCSY1803140194CQ',
        'SCSY1803140195CQ',
        'SCSY1803140196CQ',
        'SCSY1803140197CQ',
        'SCSY1803140198CQ',
        'SCSY1803140199CQ',
        'SCSY1803140200CQ',
        'SCSY1803140201DL',
        'SCSY1803140202DL',
        'SCSY1803140203DL',
        'SCSY1803140204DL',
        'SCSY1803140205DL',
        'SCSY1803140206DL',
        'SCSY1803140207DL',
        'SCSY1803140208DL',
        'SCSY1803140209DL',
        'SCSY1803140210DL',
        'SCSY1803140211GY',
        'SCSY1803140212GY',
        'SCSY1803140213GY',
        'SCSY1803140214GY',
        'SCSY1803140215GY',
        'SCSY1803140216GY',
        'SCSY1803140217GY',
        'SCSY1803140218GY',
        'SCSY1803140219GY',
        'SCSY1803140220GY',
        'SCSY1803140221JN',
        'SCSY1803140222JN',
        'SCSY1803140223JN',
        'SCSY1803140224JN',
        'SCSY1803140225JN',
        'SCSY1803140226JN',
        'SCSY1803140227JN',
        'SCSY1803140228JN',
        'SCSY1803140229JN',
        'SCSY1803140230JN',
        'SCSY1803140231KM',
        'SCSY1803140232KM',
        'SCSY1803140233KM',
        'SCSY1803140234KM',
        'SCSY1803140235KM',
        'SCSY1803140236KM',
        'SCSY1803140237KM',
        'SCSY1803140238KM',
        'SCSY1803140239KM',
        'SCSY1803140240KM',
        'SCSY1803140241SY',
        'SCSY1803140242SY',
        'SCSY1803140243SY',
        'SCSY1803140244SY',
        'SCSY1803140245SY',
        'SCSY1803140246SY',
        'SCSY1803140247SY',
        'SCSY1803140248SY',
        'SCSY1803140249SY',
        'SCSY1803140250SY',
        'SCSY1803140251CC',
        'SCSY1803140252CC',
        'SCSY1803140253CC',
        'SCSY1803140254CC',
        'SCSY1803140255CC',
        'SCSY1803140256CC',
        'SCSY1803140257CC',
        'SCSY1803140258CC',
        'SCSY1803140259CC',
        'SCSY1803140260CC',
        'SCSY1803140261BJ',
        'SCSY1803140262BJ',
        'SCSY1803140263BJ',
        'SCSY1803140264BJ',
        'SCSY1803140265BJ',
        'SCSY1803140266BJ',
        'SCSY1803140267BJ',
        'SCSY1803140268BJ',
        'SCSY1803140269BJ',
        'SCSY1803140270BJ',
        'SCSY1803140271BJ',
        'SCSY1803140272BJ',
        'SCSY1803140273BJ',
        'SCSY1803140274BJ',
        'SCSY1803140275BJ',
        'SCSY1803140276BJ',
        'SCSY1803140277BJ',
        'SCSY1803140278BJ',
        'SCSY1803140279BJ',
        'SCSY1803140280BJ',
        'SCSY1803140281BJ',
        'SCSY1803140282BJ',
        'SCSY1803140283BJ',
        'SCSY1803140284BJ',
        'SCSY1803140285BJ',
        'SCSY1803140286BJ',
        'SCSY1803140287BJ',
        'SCSY1803140288BJ',
        'SCSY1803140289BJ',
        'SCSY1803140290BJ',
        'SCSY1803140291GZ',
        'SCSY1803140292GZ',
        'SCSY1803140293GZ',
        'SCSY1803140294GZ',
        'SCSY1803140295GZ',
        'SCSY1803140296GZ',
        'SCSY1803140297GZ',
        'SCSY1803140298GZ',
        'SCSY1803140299GZ',
        'SCSY1803140300GZ',
        'SCSY1803140301GZ',
        'SCSY1803140302GZ',
        'SCSY1803140303GZ',
        'SCSY1803140304GZ',
        'SCSY1803140305GZ',
        'SCSY1803140306GZ',
        'SCSY1803140307GZ',
        'SCSY1803140308GZ',
        'SCSY1803140309GZ',
        'SCSY1803140310GZ',
        'SCSY1803140311GZ',
        'SCSY1803140312GZ',
        'SCSY1803140313GZ',
        'SCSY1803140314GZ',
        'SCSY1803140315GZ',
        'SCSY1803140316GZ',
        'SCSY1803140317GZ',
        'SCSY1803140318GZ',
        'SCSY1803140319GZ',
        'SCSY1803140320GZ',
        'SCSY1803140321HZ',
        'SCSY1803140322HZ',
        'SCSY1803140323HZ',
        'SCSY1803140324HZ',
        'SCSY1803140325HZ',
        'SCSY1803140326HZ',
        'SCSY1803140327HZ',
        'SCSY1803140328HZ',
        'SCSY1803140329HZ',
        'SCSY1803140330HZ',
        'SCSY1803140331HZ',
        'SCSY1803140332HZ',
        'SCSY1803140333HZ',
        'SCSY1803140334HZ',
        'SCSY1803140335HZ',
        'SCSY1803140336HZ',
        'SCSY1803140337HZ',
        'SCSY1803140338HZ',
        'SCSY1803140339HZ',
        'SCSY1803140340HZ',
        'SCSY1803140341HZ',
        'SCSY1803140342HZ',
        'SCSY1803140343HZ',
        'SCSY1803140344HZ',
        'SCSY1803140345HZ',
        'SCSY1803140346HZ',
        'SCSY1803140347HZ',
        'SCSY1803140348HZ',
        'SCSY1803140349HZ',
        'SCSY1803140350HZ',
        'SCSY1803140351SH',
        'SCSY1803140352SH',
        'SCSY1803140353SH',
        'SCSY1803140354SH',
        'SCSY1803140355SH',
        'SCSY1803140356SH',
        'SCSY1803140357SH',
        'SCSY1803140358SH',
        'SCSY1803140359SH',
        'SCSY1803140360SH',
        'SCSY1803140361SH',
        'SCSY1803140362SH',
        'SCSY1803140363SH',
        'SCSY1803140364SH',
        'SCSY1803140365SH',
        'SCSY1803140366SH',
        'SCSY1803140367SH',
        'SCSY1803140368SH',
        'SCSY1803140369SH',
        'SCSY1803140370SH',
        'SCSY1803140371SH',
        'SCSY1803140372SH',
        'SCSY1803140373SH',
        'SCSY1803140374SH',
        'SCSY1803140375SH',
        'SCSY1803140376SH',
        'SCSY1803140377SH',
        'SCSY1803140378SH',
        'SCSY1803140379SH',
        'SCSY1803140380SH',
        'SCSY1803140381SZ',
        'SCSY1803140382SZ',
        'SCSY1803140383SZ',
        'SCSY1803140384SZ',
        'SCSY1803140385SZ',
        'SCSY1803140386SZ',
        'SCSY1803140387SZ',
        'SCSY1803140388SZ',
        'SCSY1803140389SZ',
        'SCSY1803140390SZ',
        'SCSY1803140391SZ',
        'SCSY1803140392SZ',
        'SCSY1803140393SZ',
        'SCSY1803140394SZ',
        'SCSY1803140395SZ',
        'SCSY1803140396SZ',
        'SCSY1803140397SZ',
        'SCSY1803140398SZ',
        'SCSY1803140399SZ',
        'SCSY1803140400SZ',
        'SCSY1803140401SZ',
        'SCSY1803140402SZ',
        'SCSY1803140403SZ',
        'SCSY1803140404SZ',
        'SCSY1803140405SZ',
        'SCSY1803140406SZ',
        'SCSY1803140407SZ',
        'SCSY1803140408SZ',
        'SCSY1803140409SZ',
        'SCSY1803140410SZ',
        'SCSY1803140411WH',
        'SCSY1803140412WH',
        'SCSY1803140413WH',
        'SCSY1803140414WH',
        'SCSY1803140415WH',
        'SCSY1803140416WH',
        'SCSY1803140417WH',
        'SCSY1803140418WH',
        'SCSY1803140419WH',
        'SCSY1803140420WH',
        'SCSY1803140421WH',
        'SCSY1803140422WH',
        'SCSY1803140423WH',
        'SCSY1803140424WH',
        'SCSY1803140425WH',
        'SCSY1803140426WH',
        'SCSY1803140427WH',
        'SCSY1803140428WH',
        'SCSY1803140429WH',
        'SCSY1803140430WH',
        'SCSY1803140431WH',
        'SCSY1803140432WH',
        'SCSY1803140433WH',
        'SCSY1803140434WH',
        'SCSY1803140435WH',
        'SCSY1803140436WH',
        'SCSY1803140437WH',
        'SCSY1803140438WH',
        'SCSY1803140439WH',
        'SCSY1803140440WH',
        'SCSY1803140441ZZ',
        'SCSY1803140442ZZ',
        'SCSY1803140443ZZ',
        'SCSY1803140444ZZ',
        'SCSY1803140445ZZ',
        'SCSY1803140446ZZ',
        'SCSY1803140447ZZ',
        'SCSY1803140448ZZ',
        'SCSY1803140449ZZ',
        'SCSY1803140450ZZ',
        'SCSY1803140451ZZ',
        'SCSY1803140452ZZ',
        'SCSY1803140453ZZ',
        'SCSY1803140454ZZ',
        'SCSY1803140455ZZ',
        'SCSY1803140456ZZ',
        'SCSY1803140457ZZ',
        'SCSY1803140458ZZ',
        'SCSY1803140459ZZ',
        'SCSY1803140460ZZ',
        'SCSY1803140461ZZ',
        'SCSY1803140462ZZ',
        'SCSY1803140463ZZ',
        'SCSY1803140464ZZ',
        'SCSY1803140465ZZ',
        'SCSY1803140466ZZ',
        'SCSY1803140467ZZ',
        'SCSY1803140468ZZ',
        'SCSY1803140469ZZ',
        'SCSY1803140470ZZ',
        'SCSY1803140471DX',
        'SCSY1803140472DX',
        'SCSY1803140473DX',
        'SCSY1803140474DX',
        'SCSY1803140475DX',
        'SCSY1803140476DX',
        'SCSY1803140477DX',
        'SCSY1803140478DX',
        'SCSY1803140479DX',
        'SCSY1803140480DX',
        'SCSY1803140481DX',
        'SCSY1803140482DX',
        'SCSY1803140483DX',
        'SCSY1803140484DX',
        'SCSY1803140485DX',
        'SCSY1803140486DX',
        'SCSY1803140487DX',
        'SCSY1803140488DX',
        'SCSY1803140489DX',
        'SCSY1803140490DX',
        'SCSY1803140491DX',
        'SCSY1803140492DX',
        'SCSY1803140493DX',
        'SCSY1803140494DX',
        'SCSY1803140495DX',
        'SCSY1803140496DX',
        'SCSY1803140497DX',
        'SCSY1803140498DX',
        'SCSY1803140499DX',
        'SCSY1803140500DX',
    ];

    public $newEmail = [
        'liqing@doumi.com',
        'gengchang@doumi.com',
        'cuican@doumi.com',
        'wuxiaodie@doumi.com',
        'pengyi@doumi.com',
        'ouyanghui@doumi.com',
        'fangchunxue@doumi.com',
        'shiduxin@doumi.com',
        'lihuiling@doumi.com',
        'liboran@doumi.com',
        'liuzhu1@doumi.com',
        'lixiaotong@doumi.com',
        'liangqin@doumi.com',
        'zhangxin2@doumi.com',
        'wangjiajia@doumi.com',
        'gaokeli@doumi.com',
        'lishuyan1@doumi.com',
        'yangying@doumi.com',
        'zhangmeng5@doumi.com',
        'tianyangyang@doumi.com',
        'xuli4@doumi.com',
        'xusiming@doumi.com',
        'xiongyu@doumi.com',
        'yuyan1@doumi.com',
        'qiudanyi@doumi.com',
        'fanjinfeng@doumi.com',
        'mengtiantian1@doumi.com',
        'juxiaotong@doumi.com',
        'huangyannan@doumi.com',
    ];

    public $newEmailCity = [
        ['liqing@doumi.com','武汉'],
        ['gengchang@doumi.com','西安'],
        ['cuican@doumi.com','郑州'],
        ['wuxiaodie@doumi.com','杭州'],
        ['pengyi@doumi.com','成都'],
        ['ouyanghui@doumi.com','深圳'],
        ['fangchunxue@doumi.com','济南'],
        ['shiduxin@doumi.com','上海'],
        ['lihuiling@doumi.com','广州'],
        ['liboran@doumi.com','青岛'],
        ['liuzhu1@doumi.com','重庆'],
        ['lixiaotong@doumi.com','沈阳'],
        ['liangqin@doumi.com','长沙'],
        ['zhangxin2@doumi.com','南京'],
        ['wangjiajia@doumi.com','石家庄'],
        ['gaokeli@doumi.com','合肥'],
        ['lishuyan1@doumi.com','天津'],
        ['yangying@doumi.com','贵阳'],
        ['zhangmeng5@doumi.com','太原'],
        ['tianyangyang@doumi.com','大连'],
        ['xuli4@doumi.com','昆明'],
        ['xusiming@doumi.com','厦门'],
        ['xiongyu@doumi.com','南昌'],
        ['yuyan1@doumi.com','苏州'],
        ['qiudanyi@doumi.com','福州'],
        ['fanjinfeng@doumi.com','长春'],
        ['mengtiantian1@doumi.com','北京'],
        ['juxiaotong@doumi.com','电销'],
        ['huangyannan@doumi.com','经纪人事业部-天津'],
    ];

    //
    public function __construct(Request $request, ProjectLogModel $projectLogModel, LedgerModel $ledgerModel, UserModel $userModel)
    {
        $this->request = $request;
        $this->projectLogModel = $projectLogModel;
        $this->userModel = $userModel;
        $this->ledgerModel = $ledgerModel;
    }

    public function index()
    {
        $projectLog = $this->projectLogModel->where('id', 32)->pluck('create_at')->toArray();

        dd($projectLog);
    }


    /**
     * sql语句变更领用者id
     */
    public function info(){
        $userCity = $this->getUserCity();
        $arr = collect($userCity)->groupBy(1)->toArray();
        $email_city = $this->getIdCity();
        $str = '';
        foreach ($email_city as $key => $value){

            $temp = trim($value['use_department_city_code'],' ');
            $str .= 'update jz_ledger set bd_apply_user_id = '.$arr[$temp][0][2]
            .' where id = '.$value['ledger_id'].
'<br />';
        }
        echo $str;
    }

    public function getUserCity(){
        $userInfo = $this->userModel->whereIn('email',$this->email)->get(['user_id','email'])->toArray();
        $arr = collect($userInfo)->groupBy('email')->toArray();
        foreach ($this->email_city as $k => $v){
            $this->email_city[$k][2] = $arr[$this->email_city[$k][0]][0]['user_id'];
        }
        return $this->email_city;
    }

    public function getIdCity(){
        $ledgerInfo = $this->ledgerModel->whereIn('contract_no',$this->ledger_no)->get(['ledger_id','contract_no','use_department_city_code'])->toArray();
        return $ledgerInfo;
    }

    public function getNewUserCity(){
        $userInfo = $this->userModel->whereIn('email',$this->newEmail)->get(['user_id','email'])->toArray();
        $arr = collect($userInfo)->groupBy('email')->toArray();
        foreach ($this->newEmailCity as $k => $v){
           if($this->newEmailCity[$k][0] == 'xiongyu@doumi.com'){
                echo $arr[$this->newEmailCity[$k][0]][0]['user_id'];
           }
            $this->newEmailCity[$k][2] = $arr[$this->newEmailCity[$k][0]][0]['user_id'];
        }
        return $this->newEmailCity;
    }
}
